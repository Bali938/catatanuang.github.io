<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CATATAN UANG</title>

<style>
*{box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{
  margin:0;min-height:100vh;overflow:hidden;
  display:flex;align-items:center;justify-content:center;
  background:#020111;color:#fff;
}

/* ===== CANVAS ===== */
canvas{
  position:fixed;inset:0;
  z-index:-2;
  pointer-events:none;
}

/* ===== CARD ===== */
.card{
  width:100%;max-width:420px;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(20px);
  border-radius:22px;
  padding:24px;
  box-shadow:0 0 70px rgba(0,0,0,.9);
}

h1{
  text-align:center;
  background:linear-gradient(90deg,#00e5ff,#7c4dff,#00e5ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* ===== FORM ===== */
form{display:flex;flex-direction:column;gap:12px}
input,select{
  padding:12px;border-radius:14px;border:none;font-size:1em
}

/* ===== GOOGLE BUTTON ===== */
button{
  padding:12px;border-radius:14px;border:none;
  font-size:1em;font-weight:900;cursor:pointer;color:#fff;
  background:linear-gradient(
    90deg,#4285F4,#EA4335,#FBBC05,#34A853,#4285F4
  );
  background-size:300% 100%;
  animation:googleRun 5s linear infinite;
}
button:hover{animation-duration:2s}
button:active{transform:scale(.95)}

@keyframes googleRun{
  from{background-position:0% 50%}
  to{background-position:100% 50%}
}

.link{text-align:center;font-size:.9em}
.link a{color:#00e5ff;text-decoration:none}

.top{display:flex;justify-content:space-between;align-items:center}
.logout{background:#555}

.saldo{
  text-align:center;
  font-size:1.6em;
  color:#00e676;
  font-weight:900;
  margin-top:10px;
}

/* POWERED BY */
.powered{
  margin-top:6px;
  font-size:.8em;
  font-weight:700;
  letter-spacing:1px;
  background:linear-gradient(90deg,#00e5ff,#7c4dff,#00e5ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:poweredGlow 4s linear infinite;
}
@keyframes poweredGlow{
  from{background-position:0%}
  to{background-position:200%}
}

.item{
  display:flex;justify-content:space-between;align-items:center;
  background:rgba(255,255,255,.12);
  padding:10px;border-radius:12px;margin-top:8px
}
.in{border-left:4px solid #2ecc71}
.out{border-left:4px solid #ff5252}
.delete{background:#ff1744;border:none;border-radius:8px;color:#fff}

/* LOGIN SHAKE */
@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  50%{transform:translateX(6px)}
  75%{transform:translateX(-6px)}
  100%{transform:translateX(0)}
}
</style>
</head>

<body>

<canvas id="scene"></canvas>

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h1>Finance Tracker</h1>
  <form id="loginForm">
    <input id="loginUser" placeholder="Username" required>
    <input id="loginPass" type="password" placeholder="Password" required>
    <button type="submit">LOGIN</button>
  </form>
  <div class="link">Belum punya akun? <a href="#" onclick="showRegister()">Daftar</a></div>
</div>

<!-- REGISTER -->
<div class="card" id="registerBox" style="display:none">
  <h1>Daftar</h1>
  <form id="registerForm">
    <input id="regUser" placeholder="Username" required>
    <input id="regPass" type="password" required>
    <button>DAFTAR</button>
  </form>
  <div class="link"><a href="#" onclick="showLogin()">Kembali</a></div>
</div>

<!-- APP -->
<div class="card" id="appBox" style="display:none">
  <div class="top">
    <b id="greet"></b>
    <button class="logout" onclick="logout()">Logout</button>
  </div>

  <form id="trxForm">
    <input id="desc" placeholder="Deskripsi" required>
    <input id="amount" type="number" placeholder="Jumlah" required>
    <select id="type">
      <option value="in">Pemasukan</option>
      <option value="out">Pengeluaran</option>
    </select>
    <button type="submit">TAMBAH</button>
  </form>

  <div class="saldo">
    Rp <span id="saldo">0</span>
    <div class="powered">Powered by Bali</div>
  </div>

  <div id="list"></div>
</div>

<script>
/* ===== CANVAS ===== */
const c=document.getElementById("scene");
const ctx=c.getContext("2d");
let w,h;
function resize(){w=c.width=innerWidth;h=c.height=innerHeight}
addEventListener("resize",resize);resize();

/* ===== MOON ===== */
function drawMoon(){
  ctx.save();
  ctx.translate(w-90,90);
  ctx.shadowColor="rgba(255,255,220,.8)";
  ctx.shadowBlur=30;

  ctx.beginPath();
  ctx.arc(0,0,36,0,Math.PI*2);
  ctx.fillStyle="rgba(255,255,220,.95)";
  ctx.fill();

  ctx.globalCompositeOperation="destination-out";
  ctx.beginPath();
  ctx.arc(14,0,36,0,Math.PI*2);
  ctx.fill();

  ctx.restore();
  ctx.globalCompositeOperation="source-over";
}

/* ===== HUJAN HALUS ===== */
let rain=[];
for(let i=0;i<260;i++){
  rain.push({
    x:Math.random()*w,
    y:Math.random()*h,
    l:Math.random()*22+18,
    s:Math.random()*5+6,
    wind:Math.random()*1.2+.6
  });
}

let fog=0;
function animate(){
  ctx.clearRect(0,0,w,h);
  drawMoon();

  ctx.strokeStyle="rgba(180,200,255,.55)";
  ctx.lineWidth=1;
  ctx.beginPath();
  for(let r of rain){
    ctx.moveTo(r.x,r.y);
    ctx.lineTo(r.x+r.wind*2,r.y+r.l);
    r.y+=r.s;
    r.x-=r.wind;
    if(r.y>h||r.x<0){
      r.y=-40;r.x=Math.random()*w;
    }
  }
  ctx.stroke();

  fog+=0.08;
  ctx.fillStyle="rgba(200,220,255,.03)";
  ctx.fillRect(Math.sin(fog)*50,0,w,h);

  requestAnimationFrame(animate);
}
animate();

/* ===== APP LOGIC ===== */
const loginBox=document.getElementById("loginBox");
const registerBox=document.getElementById("registerBox");
const appBox=document.getElementById("appBox");

let akun=JSON.parse(localStorage.getItem("akun"))||[];
let trx=JSON.parse(localStorage.getItem("trx"))||[];

function showRegister(){loginBox.style.display="none";registerBox.style.display="block"}
function showLogin(){registerBox.style.display="none";loginBox.style.display="block"}
function logout(){appBox.style.display="none";showLogin()}

loginForm.onsubmit=e=>{
  e.preventDefault();
  const ok=akun.find(a=>a.u===loginUser.value&&a.p===loginPass.value);
  if(!ok){
    loginBox.style.animation="shake .4s";
    loginBox.style.boxShadow="0 0 30px rgba(255,0,0,.8)";
    setTimeout(()=>{
      loginBox.style.animation="";
      loginBox.style.boxShadow="0 0 70px rgba(0,0,0,.9)";
    },400);
    return;
  }
  greet.innerText="Halo, "+loginUser.value;
  loginBox.style.display="none";
  appBox.style.display="block";
  render();
};

registerForm.onsubmit=e=>{
  e.preventDefault();
  akun.push({u:regUser.value,p:regPass.value});
  localStorage.setItem("akun",JSON.stringify(akun));
  showLogin();
};

trxForm.onsubmit=e=>{
  e.preventDefault();
  trx.push({d:desc.value,a:+amount.value,t:type.value});
  localStorage.setItem("trx",JSON.stringify(trx));
  trxForm.reset();
  render();
};

function render(){
  let s=0;list.innerHTML="";
  trx.forEach((x,i)=>{
    s+=x.t==="in"?x.a:-x.a;
    list.innerHTML+=`
      <div class="item ${x.t}">
        <div>${x.d}</div>
        <div>Rp ${x.a.toLocaleString()}</div>
        <button class="delete" onclick="del(${i})">Ã—</button>
      </div>`;
  });
  saldo.innerText=s.toLocaleString();
}
function del(i){
  trx.splice(i,1);
  localStorage.setItem("trx",JSON.stringify(trx));
  render();
}
</script>

</body>
</html>
